
@model IEnumerable<QLDA.Models.tbl_CongViec>

<style>

    tr.level-1 td:first-child {
        padding-left: 40px !important;
    }

    tr.level-2 td:first-child {
        padding-left: 60px !important;
    }

    tr.level-3 td:first-child {
        padding-left: 80px !important;
    }
</style>

@helper DisplayRecursively(IEnumerable<QLDA.Models.tbl_CongViec> models, int? Id = null, string parentNumber = "")
{
    var i = 1;

    foreach (var item in models.Where(x => x.ParentID == Id))
    {
        string currentNumber = String.IsNullOrEmpty(parentNumber) ? i.ToString() : parentNumber + "." + i;
        <tr class="level-@currentNumber.Count(c => c == '.')">


            <td>@currentNumber</td>
            <td class="">@item.MucTieu </td>
            <td class="">@item.ThoiGianHoanThanh (h)</td>
            <td class="">@item.TienDo (%)</td>

            @{ if (item.TrangThai == true)
                {
                    <td class=""> Đã triển khai </td>
                }
                else
                {
                    <td class=""> Đã hủy </td>
                }
            }

            @* <td>@Html.DisplayFor(modelItem => item.Ho) @Html.DisplayFor(modelItem => item.Ten, new { htmlAttributes = new { id = "idnv" } })</td>*@
            <td>
                <input type="button" class="btn btn-danger btn-sm" id="childButton" value="Xóa" data-maNv="@item.MaCongViec" data-toggle="modal" data-target="#congViecModal-@item.MaCongViec" />
                <input type="button" class="btn btn-primary btn-sm" id="myInput" value="Chỉnh sửa" data-maNv="@item.MaCongViec" data-toggle="modal" data-target="#editCongViecModal-@item.MaCongViec" />

                 <a href="/CongViec/ChiTiet/@item.MaCongViec" class="btn btn-sm btn-info">Chi tiết</a>
                @*<input type="button" class="btn btn-danger btn-sm" id="childButton" value="Chỉnh sửa" data-maNv="@item.MaCongViec" data-toggle="modal" data-target="#editCongViecModal" />*@


                <!-- Modal xoa cong viec-->
                <div class="modal fade" id="congViecModal-@item.MaCongViec" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                Bạn chắc chăn muốn bỏ công việc này khỏi dự án?
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="button" onclick="xoaCongViec(@item.MaCongViec)" class="btn btn-primary">Save changes</button>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Modal sửa công việc-->
                <div class="modal fade" id="editCongViecModal-@item.MaCongViec" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Cập nhật công việc</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <fieldset style="position: relative">
                                    <input type="text" id="mucTieuEdit-@item.MaCongViec" class="form-control mr-1" placeholder="Nhập mục tiêu công việc" value="@item.MucTieu" />
                                    <p style="position: absolute; top: 45px; color:red; font-size:12px" id="error1"></p>
                                </fieldset>

                                <fieldset style="position: relative" class="mt-3">
                                    <input type="text" id="chiTietEdit-@item.MaCongViec" class="form-control mr-1 mt-3" placeholder="Chi tiết công việc" value="@item.ChiThietCongViec" />
                                    <p style="position: absolute; top: 45px; color:red; font-size:12px" id="error2"></p>
                                </fieldset>

                                <fieldset style="position: relative" class="mt-3">
                                    <input type="number" min="0" id="thoiGianHoanThanhEdit-@item.MaCongViec" class="form-control mr-1 mt-3" value="@item.ThoiGianHoanThanh" placeholder="Thời gian hoàn thành" step="0.01" value="0.00" />
                                    <p style="position: absolute; top: 45px; color:red; font-size:12px" id="error3"></p>
                                </fieldset>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary" onclick="suaCongViec(@item.MaCongViec)">Lưu</button>
                            </div>
                        </div>
                    </div>
                </div>



            </td>
            @*@Html.Action("dsNhanVienTrongCongViec", "CongViec")*@
        </tr>


        @DisplayRecursively(models, item.MaCongViec, currentNumber)
        i++;
    }

}



@DisplayRecursively(Model, null)

